
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>t_oiWave</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-08-13"><meta name="DC.source" content="t_oiWave.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">t_oiWave</a></li><li><a href="#2">Make an MCC</a></li><li><a href="#3">Create a new scene with subsampled wavelengths</a></li><li><a href="#4">Pull out one wavelength</a></li><li><a href="#5">Now start computing with an oi</a></li><li><a href="#6">Compute with a monochrome case</a></li><li><a href="#7">A section</a></li><li><a href="#8">Fine sampling</a></li><li><a href="#9">Uniform monochromatic cases</a></li><li><a href="#10">What happens when we go out of range?</a></li><li><a href="#11">Interpolate on the oi itself</a></li></ul></div><h2>t_oiWave<a name="1"></a></h2><p>Do some unit testing about changing the wavelength samples in a scene and an optical image</p><p>This arose because there was a moment when BW had difficulty in ISETBIO with creating and analyzing monochromatic scenes.  The management of wavelength and computation with these scenes ran into trouble because some data were cleared (or not).  So the photon data that had been interpolated in oiSet() was eliminated, and I started worrying.</p><p>Also, I stopped clearing optics data.</p><pre class="codeinput">ieInit
</pre><h2>Make an MCC<a name="2"></a></h2><pre class="codeinput">scene0 = sceneCreate;
wave0 = sceneGet(scene0,<span class="string">'wave'</span>);
vcAddObject(scene0); sceneWindow;
</pre><img vspace="5" hspace="5" src="t_oiWave_01.png" alt=""> <h2>Create a new scene with subsampled wavelengths<a name="3"></a></h2><pre class="codeinput">wave = wave0(1:2:end);
scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
vcAddObject(scene); sceneWindow;
</pre><img vspace="5" hspace="5" src="t_oiWave_02.png" alt=""> <h2>Pull out one wavelength<a name="4"></a></h2><pre class="codeinput">wave = 500;
scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
vcAddObject(scene); sceneWindow;
</pre><pre class="codeoutput">10 nm band assumed
</pre><img vspace="5" hspace="5" src="t_oiWave_03.png" alt=""> <h2>Now start computing with an oi<a name="5"></a></h2><pre class="codeinput">oi = oiCreate(<span class="string">'human'</span>);
oi = oiCompute(oi,scene0);
oi0 = oi;
vcAddObject(oi); oiWindow;
</pre><img vspace="5" hspace="5" src="t_oiWave_04.png" alt=""> <h2>Compute with a monochrome case<a name="6"></a></h2><pre class="codeinput">wave = 500;
scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;
</pre><pre class="codeoutput">Interpolating OI photon data
10 nm band assumed
</pre><img vspace="5" hspace="5" src="t_oiWave_05.png" alt=""> <h2>A section<a name="7"></a></h2><pre class="codeinput">wave = 500:30:620;
scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;
</pre><pre class="codeoutput">Extrapolation -  Setting oi photon data to zero.
</pre><img vspace="5" hspace="5" src="t_oiWave_06.png" alt=""> <h2>Fine sampling<a name="8"></a></h2><pre class="codeinput">wave = 500:1:520;
scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;
</pre><pre class="codeoutput">Extrapolation -  Setting oi photon data to zero.
</pre><img vspace="5" hspace="5" src="t_oiWave_07.png" alt=""> <h2>Uniform monochromatic cases<a name="9"></a></h2><pre class="codeinput">wList = 400:100:600;
<span class="keyword">for</span> ww=1:length(wList)
    mscene = sceneCreate(<span class="string">'uniform monochromatic'</span>,wList(ww));
    oi = oiCompute(oi,mscene);
    oi = oiSet(oi,<span class="string">'name'</span>,sprintf(<span class="string">'%d'</span>,wList(ww)));
    vcAddObject(oi); oiWindow;
<span class="keyword">end</span>
</pre><pre class="codeoutput">ieLuminanceFromEnergy monochrome: 10 nm band assumed
Extrapolation -  Setting oi photon data to zero.
10 nm band assumed
ieLuminanceFromEnergy monochrome: 10 nm band assumed
Extrapolation -  Setting oi photon data to zero.
10 nm band assumed
ieLuminanceFromEnergy monochrome: 10 nm band assumed
Extrapolation -  Setting oi photon data to zero.
10 nm band assumed
</pre><img vspace="5" hspace="5" src="t_oiWave_08.png" alt=""> <h2>What happens when we go out of range?<a name="10"></a></h2><pre class="codeinput">wave = 390:450;
<span class="keyword">try</span>
    scene = sceneSet(scene0,<span class="string">'wave'</span>,wave);
<span class="keyword">catch</span>
    disp(<span class="string">'Extrapolation not allowed'</span>)
<span class="keyword">end</span>
</pre><pre class="codeoutput">Extrapolation not allowed
</pre><h2>Interpolate on the oi itself<a name="11"></a></h2><pre class="codeinput">wave = wave0(1:2:end);
oi = oiSet(oi0,<span class="string">'wave'</span>,wave);

scene = sceneCreate;
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;
</pre><pre class="codeoutput">Extrapolation -  Setting oi photon data to zero.
Extrapolation -  Setting oi photon data to zero.
</pre><img vspace="5" hspace="5" src="t_oiWave_09.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% t_oiWave
%
% Do some unit testing about changing the wavelength samples in a scene and
% an optical image
%
% This arose because there was a moment when BW had difficulty in ISETBIO
% with creating and analyzing monochromatic scenes.  The management of
% wavelength and computation with these scenes ran into trouble because
% some data were cleared (or not).  So the photon data that had been
% interpolated in oiSet() was eliminated, and I started worrying.
%  
% Also, I stopped clearing optics data.
%
ieInit

%% Make an MCC
scene0 = sceneCreate;
wave0 = sceneGet(scene0,'wave');
vcAddObject(scene0); sceneWindow;

%% Create a new scene with subsampled wavelengths
wave = wave0(1:2:end);
scene = sceneSet(scene0,'wave',wave);
vcAddObject(scene); sceneWindow;

%% Pull out one wavelength
wave = 500;
scene = sceneSet(scene0,'wave',wave);
vcAddObject(scene); sceneWindow;

%% Now start computing with an oi
oi = oiCreate('human');
oi = oiCompute(oi,scene0);
oi0 = oi;
vcAddObject(oi); oiWindow;

%% Compute with a monochrome case
wave = 500;
scene = sceneSet(scene0,'wave',wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;

%% A section
wave = 500:30:620;
scene = sceneSet(scene0,'wave',wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;

%% Fine sampling
wave = 500:1:520;
scene = sceneSet(scene0,'wave',wave);
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;

%% Uniform monochromatic cases
wList = 400:100:600;
for ww=1:length(wList)
    mscene = sceneCreate('uniform monochromatic',wList(ww));
    oi = oiCompute(oi,mscene);
    oi = oiSet(oi,'name',sprintf('%d',wList(ww)));
    vcAddObject(oi); oiWindow;
end

%% What happens when we go out of range?
wave = 390:450;
try
    scene = sceneSet(scene0,'wave',wave);
catch
    disp('Extrapolation not allowed')
end

%% Interpolate on the oi itself
wave = wave0(1:2:end); 
oi = oiSet(oi0,'wave',wave);

scene = sceneCreate;
oi = oiCompute(oi,scene);
vcAddObject(oi); oiWindow;



%%



 
##### SOURCE END #####
--></body></html>